#!/bin/bash
clear
################################################################################
# Written By: Captain Stormy
#===============================================================================
# Purpose:
#   Uses Rsync to backup files to Archive HDD.
################################################################################

################################################################################
#   Define Variables
################################################################################
# Static Variables
FromLocation=/home/$USER
ToLocation=/mnt/$USER/archive/Backups/
year=$(date +'%Y')
date=$(date +"%m-%d-%Y")

# Dynamic Variables
now=$(date +'%m/%d/%Y %r')

################################################################################
#   Define Functions
################################################################################
timestamp()
{
    now=$(date +'%m/%d/%Y %r')
}

################################################################################
#   Main Processing
################################################################################
timestamp

echo "##########################################################################"
echo "# Rsync process started by $USER on $now"
echo "##########################################################################"
echo

echo "--------------------------------------------------------------------------"
echo "- Create $ToLocation$year"
echo "--------------------------------------------------------------------------"
echo
sudo mkdir $ToLocation$year 2> /dev/null;
sudo chmod 770 $ToLocation$year;
echo

echo "--------------------------------------------------------------------------"
echo "- Create $ToLocation$year/$date"
echo "--------------------------------------------------------------------------"
echo
sudo mkdir $ToLocation$year/$date 2> /dev/null;
sudo chmod 770 $ToLocation$year/$date;
echo

echo "--------------------------------------------------------------------------"
echo "- Backup $FromLocation"
echo "--------------------------------------------------------------------------"
echo
sudo rsync -avh $FromLocation $ToLocation$year/$date;
echo

timestamp

echo "##########################################################################"
echo "# Rsync process completed by $USER on $now"
echo "##########################################################################"
echo
